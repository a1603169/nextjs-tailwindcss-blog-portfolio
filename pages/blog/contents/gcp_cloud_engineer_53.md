---
title: 'GCP Cloud Engineer - 53'
subtitle: 'Essential Cloud Infrastructure: Sacling and Automation - HTTP(S) Load Balancing'
date: '2024-04-18'
tags: [Cloud, GCP]
---

### **HTTP(S) 부하 분산**

- **`레이어 7 부하 분산`**:
  
  - 애플리케이션 레이어에서 작동하며, `URL 기반 라우팅을 사용하여 트래픽을 관리`합니다.

- **`전역 및 리전 간 부하 분산`**:
  
  - 여러 리전에 걸친 백엔드 인스턴스로 `HTTP 및 HTTPS 트래픽을 분산`합니다.
  
  - `전역 애니캐스트 IP 주소`를 사용하여 `DNS 설정 간소화`.


- **`부하 분산 구성 요소`**:
  
  - `전역 전달 규칙`: 인터넷에서 들어오는 `요청을 대상 HTTP(S) 프록시로 라우팅`합니다.
  
  - `대상 HTTP(S) 프록시`: `URL 맵을 사용`하여 `적절한 백엔드 서비스를 결정`합니다.
  
  - `백엔드 서비스`: `상태 점검`과 `세션 어피니티 설정`을 포함하여 적절한 백엔드로 요청을 라우팅합니다.


- **`URL 맵`**:
  
  - `특정 URL`을 `특정 인스턴스 그룹으로 라우팅`하는 규칙을 설정합니다.


- **`부하 분산기의 동작`**:
  
  - `가장 가까운 인스턴스 그룹으로 라우팅`되며, 용량이 부족한 경우 `다음으로 가까운 그룹으로 이동`합니다.
  
  - 세션 어피니티를 사용하여 `동일 클라이언트의 모든 요청을 동일 인스턴스로 보낼 수 있습니다`.

### **HTTPS 부하 분산의 추가 기능**

- **`SSL 인증서`**:
  
  - `HTTPS 부하 분산`을 위해 `하나 이상의 서명된 SSL` 인증서가 필요합니다.
  
  - `클라이언트 SSL 세션`은 `부하 분산기에서 종료`됩니다.


- **`QUIC 프로토콜 지원`**:
  
  - `연결 초기화 시간 감소`, `스트림 대기열 막힘 제거`, `IP 주소 변경 시 연결 유지`를 지원합니다.

### **백엔드 버킷 및 네트워크 엔드포인트 그룹 (NEG)**

- **`백엔드 버킷`**:
  
  - `Google Cloud Storage`와 함께 사용하여 `정적 및 동적 콘텐츠를 부하 분산`할 수 있습니다.
  
  - `URL 맵`을 통해 `특정 경로의 트래픽`을 `Cloud Storage 버킷으로 라우팅`합니다.


- **`NEG의 종류 및 기능`**:
  
  - `영역 NEG`: `Compute Engine VM` 또는 `VM 실행 서비스`와 같은 `엔드포인트를 포함`합니다.
  
  - `인터넷 NEG`: Google Cloud `외부에서 호스팅되는 단일 엔드포인트를 포함`합니다.
  
  - `서버리스 NEG`: Cloud Run, App Engine, Cloud Functions 서비스와 같은 `서버리스 서비스를 포함`합니다.

----------------------

### 모르는 단어

#### 세션 어피니티

세션 어피니티, 또는 스티키 세션(Sticky Session)은 로드 밸런싱에서 사용되는 개념으로, 특정 클라이언트의 모든 요청이 동일한 서버로 라우팅되도록 하는 기능을 의미합니다.

이 기능은 사용자의 세션 상태를 유지하는 데 필요한 정보가 서버에 저장되는 경우에 유용합니다. 

예를 들어, 웹 애플리케이션에서 사용자가 로그인한 후 그 사용자의 모든 요청을 동일한 서버로 라우팅하면, 그 서버에 저장된 세션 정보를 계속 사용할 수 있습니다.

세션 어피니티는 사용자 경험을 개선할 수 있지만, 로드 밸런싱을 완벽하게 수행하지 못하게 할 수 있습니다. 

예를 들어, 특정 서버에 과도한 요청이 집중되어 다른 서버들이 비어 있게 될 수 있습니다. 

따라서 세션 어피니티를 사용할 때는 이러한 점을 고려해야 합니다.

